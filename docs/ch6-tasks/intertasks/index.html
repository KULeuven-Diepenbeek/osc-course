<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.79.1" />
    <meta name="description" content="">


    <link rel="icon" href="../../images/favicon.png" type="image/png">

    <title>6.5: Inter task communication :: Operating Systems and C</title>

    
    <link href="../../css/nucleus.css?1613375963" rel="stylesheet">
    <link href="../../css/fontawesome-all.min.css?1613375963" rel="stylesheet">
    <link href="../../css/hybrid.css?1613375963" rel="stylesheet">
    <link href="../../css/featherlight.min.css?1613375963" rel="stylesheet">
    <link href="../../css/perfect-scrollbar.min.css?1613375963" rel="stylesheet">
    <link href="../../css/auto-complete.css?1613375963" rel="stylesheet">
    <link href="../../css/atom-one-dark-reasonable.css?1613375963" rel="stylesheet">
    <link href="../../css/theme.css?1613375963" rel="stylesheet">
    <link href="../../css/hugo-theme.css?1613375963" rel="stylesheet">
    
    <link href="../../css/theme-kul.css?1613375963" rel="stylesheet">
    
    

    <script src="../../js/jquery-3.3.1.min.js?1613375963"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
      <script id="MathJax-script" async
          src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>

<script>
window.MathJax = {
  chtml: {
    scale: 2,                      
    minScale: .5,                  
    matchFontHeight: true,         
    mtextInheritFont: false,       
    merrorInheritFont: true,       
    mathmlSpacing: false,          
    skipAttributes: {},            
    exFactor: .5,                  
    displayAlign: 'center',        
    displayIndent: '0'             
  }
};
</script>

<script src=../../js/osc.js></script>
  </head>
  <body class="" data-url="../../ch6-tasks/intertasks/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a href="https://www.kuleuven.be/kuleuven/" target="_blank">
	<img src="../../img/style/kul.png" alt="KU Leuven" /><br/>
</a>
<a href="https://www.uhasselt.be/" target="_blank">
	<img src="../../img/style/uhasselt.svg" alt="UHasselt" id="uhlogo" />
</a>
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="../../js/lunr.min.js?1613375963"></script>
<script type="text/javascript" src="../../js/auto-complete.js?1613375963"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/kuleuven-diepenbeek.github.io\/osc-course\/";
    
</script>
<script type="text/javascript" src="../../js/search.js?1613375963"></script>

    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='../../'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/ch1-c/" title="1: Introduction in C" class="dd-item
        
        
        
        ">
      <a href="../../ch1-c/">
          <i class='far fa-keyboard'></i> 1: Introduction in C
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/ch1-c/intro/" title="1.1: The C programming language" class="dd-item ">
        <a href="../../ch1-c/intro/">
        <i class='fas fa-book'></i> 1.1: The C programming language
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch1-c/intro-labs/" title="1.2: String Manipulation" class="dd-item ">
        <a href="../../ch1-c/intro-labs/">
        <i class='fas fa-vial'></i> 1.2: String Manipulation
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch1-c/structs/" title="1.3: Creating order: Structures" class="dd-item ">
        <a href="../../ch1-c/structs/">
        <i class='fas fa-book'></i> 1.3: Creating order: Structures
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch1-c/structs-labs/" title="1.4: Structs" class="dd-item ">
        <a href="../../ch1-c/structs-labs/">
        <i class='fas fa-vial'></i> 1.4: Structs
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch1-c/ecosystems/" title="1.5: C Ecosystems" class="dd-item ">
        <a href="../../ch1-c/ecosystems/">
        <i class='fas fa-book'></i> 1.5: C Ecosystems
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch1-c/ecosystems-labs/" title="1.6: Splitting up Code" class="dd-item ">
        <a href="../../ch1-c/ecosystems-labs/">
        <i class='fas fa-vial'></i> 1.6: Splitting up Code
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/ch2-interrupts/" title="2: Interrupts" class="dd-item
        
        
        
        ">
      <a href="../../ch2-interrupts/">
          <i class='fab fa-linux'></i> 2: Interrupts
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/ch2-interrupts/theory1_arduino/" title="2.1 Arduino UNO" class="dd-item ">
        <a href="../../ch2-interrupts/theory1_arduino/">
        <i class='fab fa-linux'></i> 2.1 Arduino UNO
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch2-interrupts/lab1_arduino-multfreq/" title="2.2: Arduino multi frequencies" class="dd-item ">
        <a href="../../ch2-interrupts/lab1_arduino-multfreq/">
        <i class='fas fa-vial'></i> 2.2: Arduino multi frequencies
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch2-interrupts/theory2_timer/" title="2.3 The timer" class="dd-item ">
        <a href="../../ch2-interrupts/theory2_timer/">
        <i class='fab fa-linux'></i> 2.3 The timer
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch2-interrupts/lab2_rocketlaunch/" title="2.4: Launch that rocket !!" class="dd-item ">
        <a href="../../ch2-interrupts/lab2_rocketlaunch/">
        <i class='fas fa-vial'></i> 2.4: Launch that rocket !!
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/ch3-pointers/" title="3: Pointers &amp; Arrays" class="dd-item
        
        
        
        ">
      <a href="../../ch3-pointers/">
          <i class='far fa-keyboard'></i> 3: Pointers &amp; Arrays
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/ch3-pointers/pointers/" title="3.1: Pointers and arrays" class="dd-item ">
        <a href="../../ch3-pointers/pointers/">
        <i class='far fa-keyboard'></i> 3.1: Pointers and arrays
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch3-pointers/practical-use/" title="3.2: Practical Use of Pointers" class="dd-item ">
        <a href="../../ch3-pointers/practical-use/">
        <i class='far fa-keyboard'></i> 3.2: Practical Use of Pointers
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch3-pointers/lab/" title="3.3: The Ancient Library" class="dd-item ">
        <a href="../../ch3-pointers/lab/">
        <i class='fas fa-vial'></i> 3.3: The Ancient Library
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/ch4-debugging/" title="4: Debugging" class="dd-item
        
        
        
        ">
      <a href="../../ch4-debugging/">
          <i class='far fa-keyboard'></i> 4: Debugging
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/ch4-debugging/debugging-ide/" title="4.1: The Easy Way: IDEs" class="dd-item ">
        <a href="../../ch4-debugging/debugging-ide/">
        <i class='far fa-keyboard'></i> 4.1: The Easy Way: IDEs
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch4-debugging/debugging-gdb/" title="4.2: The Hard Way: GDB" class="dd-item ">
        <a href="../../ch4-debugging/debugging-gdb/">
        <i class='fas fa-vial'></i> 4.2: The Hard Way: GDB
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch4-debugging/testing/" title="4.3: The Middle Way: TDD" class="dd-item ">
        <a href="../../ch4-debugging/testing/">
        <i class='far fa-keyboard'></i> 4.3: The Middle Way: TDD
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/ch5-introos/" title="5: Intro in OS" class="dd-item
        
        
        
        ">
      <a href="../../ch5-introos/">
          <i class='fab fa-linux'></i> 5: Intro in OS
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/ch5-introos/intro-os/" title="5.1: Intro to OS using Linux" class="dd-item ">
        <a href="../../ch5-introos/intro-os/">
        <i class='fas fa-book'></i> 5.1: Intro to OS using Linux
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch5-introos/lab1_wetfeet/" title="5.2: Getting your CLI-feet wet" class="dd-item ">
        <a href="../../ch5-introos/lab1_wetfeet/">
        <i class='fas fa-vial'></i> 5.2: Getting your CLI-feet wet
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/ch6-tasks/" title="6: Task management" class="dd-item
        parent
        
        
        ">
      <a href="../../ch6-tasks/">
          <i class='fab fa-linux'></i> 6: Task management
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/ch6-tasks/processes/" title="6.1: Processes" class="dd-item ">
        <a href="../../ch6-tasks/processes/">
        <i class='fas fa-book'></i> 6.1: Processes
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch6-tasks/lab1_processmgmt/" title="6.2: Processes (lab)" class="dd-item ">
        <a href="../../ch6-tasks/lab1_processmgmt/">
        <i class='fas fa-vial'></i> 6.2: Processes (lab)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch6-tasks/threads/" title="6.3: Threads" class="dd-item ">
        <a href="../../ch6-tasks/threads/">
        <i class='fas fa-book'></i> 6.3: Threads
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch6-tasks/lab2_threadsmgmt/" title="6.4: Threads (lab)" class="dd-item ">
        <a href="../../ch6-tasks/lab2_threadsmgmt/">
        <i class='fas fa-vial'></i> 6.4: Threads (lab)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch6-tasks/intertasks/" title="6.5: Inter task communication" class="dd-item active">
        <a href="../../ch6-tasks/intertasks/">
        <i class='fas fa-book'></i> 6.5: Inter task communication
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch6-tasks/lab3_intertaskcomm/" title="6.6: Inter task communication (lab)" class="dd-item ">
        <a href="../../ch6-tasks/lab3_intertaskcomm/">
        <i class='fas fa-vial'></i> 6.6: Inter task communication (lab)
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/ch7-scheduling/" title="7: CPU scheduling" class="dd-item
        
        
        
        ">
      <a href="../../ch7-scheduling/">
          <i class='fab fa-linux'></i> 7: CPU scheduling
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/ch7-scheduling/algorithms/" title="7.1: Scheduling algorithms" class="dd-item ">
        <a href="../../ch7-scheduling/algorithms/">
        <i class='fas fa-book'></i> 7.1: Scheduling algorithms
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch7-scheduling/lab1_algorithms/" title="7.2: Scheduling algorithms (lab)" class="dd-item ">
        <a href="../../ch7-scheduling/lab1_algorithms/">
        <i class='fas fa-vial'></i> 7.2: Scheduling algorithms (lab)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch7-scheduling/towards/" title="7.3: Towards real-world schedulers" class="dd-item ">
        <a href="../../ch7-scheduling/towards/">
        <i class='fas fa-book'></i> 7.3: Towards real-world schedulers
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch7-scheduling/lab2_niceguy/" title="7.4: Mr. nice guy(lab)" class="dd-item ">
        <a href="../../ch7-scheduling/lab2_niceguy/">
        <i class='fas fa-vial'></i> 7.4: Mr. nice guy(lab)
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/ch8-stack/" title="8: The Stack &amp; The Heap" class="dd-item
        
        
        
        ">
      <a href="../../ch8-stack/">
          <i class='far fa-keyboard'></i> 8: The Stack &amp; The Heap
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/ch8-stack/stackvsheap/" title="8.1: The Stack &amp; the Heap" class="dd-item ">
        <a href="../../ch8-stack/stackvsheap/">
        <i class='fas fa-book'></i> 8.1: The Stack &amp; the Heap
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch8-stack/inspection-labs/" title="8.2: Inspecting memory regions" class="dd-item ">
        <a href="../../ch8-stack/inspection-labs/">
        <i class='fas fa-vial'></i> 8.2: Inspecting memory regions
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch8-stack/scope/" title="8.3: Different Scopes in C" class="dd-item ">
        <a href="../../ch8-stack/scope/">
        <i class='fas fa-book'></i> 8.3: Different Scopes in C
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/ch9-memory/" title="9: Memory Management" class="dd-item
        
        
        
        ">
      <a href="../../ch9-memory/">
          <i class='fab fa-linux'></i> 9: Memory Management
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/ch9-memory/memory/" title="9.1: Memory management" class="dd-item ">
        <a href="../../ch9-memory/memory/">
        <i class='fas fa-book'></i> 9.1: Memory management
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch9-memory/lab1_segfault/" title="9.2: Deliberate Segfaulting" class="dd-item ">
        <a href="../../ch9-memory/lab1_segfault/">
        <i class='fas fa-vial'></i> 9.2: Deliberate Segfaulting
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch9-memory/paging/" title="9.3: Paging" class="dd-item ">
        <a href="../../ch9-memory/paging/">
        <i class='fas fa-book'></i> 9.3: Paging
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ch9-memory/lab2_browsing/" title="9.4: Simply browsing through pages" class="dd-item ">
        <a href="../../ch9-memory/lab2_browsing/">
        <i class='fas fa-vial'></i> 9.4: Simply browsing through pages
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/chx-cs/" title="X: Capita Selecta" class="dd-item
        
        
        
        ">
      <a href="../../chx-cs/">
          <i class='fab fa-linux'></i> X: Capita Selecta
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/chx-cs/filesystems/" title="X.1: File systems" class="dd-item ">
        <a href="../../chx-cs/filesystems/">
        <i class='fab fa-linux'></i> X.1: File systems
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/chx-cs/rtos/" title="X.2: Real-time Operating Systems" class="dd-item ">
        <a href="../../chx-cs/rtos/">
        <i class='fab fa-linux'></i> X.2: Real-time Operating Systems
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/chx-cs/devdrivers/" title="X.3: Device Drivers" class="dd-item ">
        <a href="../../chx-cs/devdrivers/">
        <i class='fab fa-linux'></i> X.3: Device Drivers
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/exercises/" title="A. Exercises Assignments" class="dd-item
        
        
        
        ">
      <a href="../../exercises/">
          <i class='fas fa-pencil-alt'></i> A. Exercises Assignments
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/exercises/c-integrated-ex/" title="1. Integrated C exercise" class="dd-item ">
        <a href="../../exercises/c-integrated-ex/">
        <i class='fas fa-pen-square'></i> 1. Integrated C exercise
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/exercises/c-debugging-testing/" title="2. Testing in C(&#43;&#43;)" class="dd-item ">
        <a href="../../exercises/c-debugging-testing/">
        <i class='fas fa-pen-square'></i> 2. Testing in C(&#43;&#43;)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/exercises/tasks_inter_thread_communication/" title="3. Inter-thread communication" class="dd-item ">
        <a href="../../exercises/tasks_inter_thread_communication/">
        <i class='fas fa-pen-square'></i> 3. Inter-thread communication
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/exercises/scheduler/" title="4. Pseudo scheduler" class="dd-item ">
        <a href="../../exercises/scheduler/">
        <i class='fas fa-pen-square'></i> 4. Pseudo scheduler
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/appendix/" title="B. Appendix" class="dd-item
        
        
        
        ">
      <a href="../../appendix/">
          <i class='fab fa-github'></i> B. Appendix
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/appendix/lab_ll_rtos/" title="3.3: The Ancient Library (RTOS)" class="dd-item ">
        <a href="../../appendix/lab_ll_rtos/">
        <i class='fas fa-vial'></i> 3.3: The Ancient Library (RTOS)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/appendix/reading/" title="1. Recommended reading" class="dd-item ">
        <a href="../../appendix/reading/">
        1. Recommended reading
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/appendix/installing/" title="2. Linux Installation Instructions" class="dd-item ">
        <a href="../../appendix/installing/">
        2. Linux Installation Instructions
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/appendix/cheat_sheet/" title="Cheat sheet" class="dd-item ">
        <a href="../../appendix/cheat_sheet/">
        Cheat sheet
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://uhintra03.uhasselt.be/studiegidswww/opleidingsonderdeel.aspx?a=2019&amp;i=4082&amp;n=4&amp;t=01"><i class='fa fa-university'></i> ECTS Sheet</a>
              </li>
          
              <li>
                  <a class="padding" href="https://kuleuven-diepenbeek.github.io/osc-course/TODO"><i class='fa fa-university'></i> Toledo</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='../../'>Operating Systems and C</a> > <a href='../../ch6-tasks/'>6: Task management</a> > 6.5: Inter task communication
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#communication-between-processes">Communication between processes</a>
<ul>
<li><a href="#shared-memory">Shared memory</a></li>
<li><a href="#message-passing">Message passing</a>
<ul>
<li><a href="#signals">Signals</a></li>
<li><a href="#pipes">Pipes</a></li>
</ul></li>
</ul></li>
<li><a href="#communication-between-threads">Communication between threads</a>
<ul>
<li><a href="#mutex">Mutex</a></li>
<li><a href="#semaphore">Semaphore</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              6.5: Inter task communication
            </h1>
          

        




<p>Having multiple tasks running is all good-and-well. Hey, it is one of the main reasons why the concept of an OS was introduced, remember ? Right, <strong>good job !!</strong></p>

<p>It would make sense, though, if different tasks were able to communicate with each other. A distinction should be made between multi-processes and multi-threading. Although both techniques are made for running multiple jobs, the communication between the jobs is much different in both.</p>

<h2 id="communication-between-processes">Communication between processes</h2>

<p>There are two main techniques to facilitate communication between multiple processes. These two techniques are shown in image below.</p>

<ol>
<li>Shared memory</li>
<li>Message passing</li>
</ol>

<figure>
    <img src="../../img/os/db_ipc.png"/> <figcaption>
            <h4>The two main techniques for inter process communication</h4>
        </figcaption>
</figure>

<p><style>
  p.dinobook {
    color: #7E7E7E;
    font-size: 14px;
    font-weight: 300;
    letter-spacing: -1px;
    padding-top: 0px;
    margin-top: -20px;
    text-align: center;
  }
</style>
<p class="dinobook">source: SILBERSCHATZ, A., GALVIN, P.B., and GAGNE, G. <i>Operating System Concepts</i>. 9<sup>th</sup> ed. Hoboken: Wiley, 2013.</p></p>

<h3 id="shared-memory">Shared memory</h3>

<p>Shared memory is &hellip; memory that is shared. Normally multiple processes are not allowed to read/write to each other&rsquo;s memory space. This is enforced by the operating system. Errors, similar to the one in the example below, are generated by the OS if a processes try to access areas that it is not allowed to access.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">void</span>) {
  <span style="color:#66d9ef">int</span> i, my_array[<span style="color:#ae81ff">8</span>];

  <span style="color:#66d9ef">for</span>(i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;i<span style="color:#f92672">&lt;=</span><span style="color:#ae81ff">8</span>;i<span style="color:#f92672">++</span>) {
    my_array[i] <span style="color:#f92672">=</span> i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>;
  }

  <span style="color:#66d9ef">for</span>(i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;i<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">8</span>;i<span style="color:#f92672">++</span>) {
    printf(<span style="color:#e6db74">&#34;%d</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, my_array[i]);
  }

  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}</code></pre></div>
<figure>
    <img src="../../img/os/sc_stacksmashing.png"/> <figcaption>
            <h4>An example of memory protection that given by the OS</h4>
        </figcaption>
</figure>


<div class="ex">
	<div class="inner">
    	<p>The code above exceeds the allowed stack space. Try to find out why this happens.</p>

	</div>
</div>

<p>The technique of using <strong>shared memory</strong> allows other processes to gain access certain regions of the address space. Both processes have to be aware that the memory is <strong>not</strong> protected by the OS. A programming API for using shared memory is provided by POSIX. The example below shows a <strong>producer</strong> on the left and a <strong>consumer</strong> on the right.</p>

<p><div class="multicolumn">
  <div class="column">
  <div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;string.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;fcntl.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;sys/shm.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;sys/mman.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
  <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> SIZE <span style="color:#f92672">=</span> <span style="color:#ae81ff">4096</span>; <span style="color:#75715e">/* buffersize (bytes) */</span>
  <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;OS&#34;</span>; <span style="color:#75715e">/* shared memory object name */</span>
  <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>message_0 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Hello&#34;</span>; <span style="color:#75715e">/* message 1 */</span>
  <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>message_1 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;World!&#34;</span>; <span style="color:#75715e">/* message 2*/</span>
  <span style="color:#66d9ef">int</span> shm_fd; <span style="color:#75715e">/* file descriptor */</span>
  <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>ptr;

  <span style="color:#75715e">/* create the shared memory object */</span>
  shm_fd <span style="color:#f92672">=</span> shm_open(name, O_CREAT <span style="color:#f92672">|</span> O_RDWR, <span style="color:#ae81ff">0666</span>);

  <span style="color:#75715e">/* configure the size of the shared memory object */</span>
  ftruncate(shm_fd, SIZE);

  <span style="color:#75715e">/* memory map the shared memory object */</span>
  ptr <span style="color:#f92672">=</span> mmap(<span style="color:#ae81ff">0</span>, SIZE, PROT_WRITE, MAP_SHARED, shm_fd, <span style="color:#ae81ff">0</span>);

  <span style="color:#75715e">/* write to the shared memory object */</span>
  sprintf(ptr,<span style="color:#e6db74">&#34;%s&#34;</span>,message_0);
  ptr <span style="color:#f92672">+=</span> strlen(message_0);
  sprintf(ptr,<span style="color:#e6db74">&#34;%s&#34;</span>,message_1);
  ptr <span style="color:#f92672">+=</span> strlen(message_1);




  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
  </code></pre></div>
  </div>
  <div class="column">
  <div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;fcntl.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;sys/shm.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;sys/mman.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
  <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> SIZE <span style="color:#f92672">=</span> <span style="color:#ae81ff">4096</span>; <span style="color:#75715e">/* buffersize (bytes) */</span>
  <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;OS&#34;</span>; <span style="color:#75715e">/* shared memory object name */</span>


  <span style="color:#66d9ef">int</span> shm_fd; <span style="color:#75715e">/* file descriptor */</span>
  <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>ptr;

  <span style="color:#75715e">/* open the shared memory object */</span>
  shm_fd <span style="color:#f92672">=</span> shm_open(name, O_RDONLY, <span style="color:#ae81ff">0666</span>);




  <span style="color:#75715e">/* memory map the shared memory object */</span>
  ptr <span style="color:#f92672">=</span> mmap(<span style="color:#ae81ff">0</span>, SIZE, PROT_READ, MAP_SHARED, shm_fd, <span style="color:#ae81ff">0</span>);


  <span style="color:#75715e">/* read from the shared memory object */</span>
  printf(<span style="color:#e6db74">&#34;%s&#34;</span>,(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)ptr);



  <span style="color:#75715e">/* remove the shared memory object */</span>
  shm_unlink(name);

  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
  </code></pre></div>
  </div>
</div>
<style>
  p.dinobook {
    color: #7E7E7E;
    font-size: 14px;
    font-weight: 300;
    letter-spacing: -1px;
    padding-top: 0px;
    margin-top: -20px;
    text-align: center;
  }
</style>
<p class="dinobook">source: SILBERSCHATZ, A., GALVIN, P.B., and GAGNE, G. <i>Operating System Concepts</i>. 9<sup>th</sup> ed. Hoboken: Wiley, 2013.</p></p>


<div class="ex">
	<div class="inner">
    	<p>This very simple example uses shared memory. Try to find answers to the questions below:</p>

<ul>
<li>Try to find out what these programs doe</li>
<li>What is the size of the memory that is shared ?</li>
<li>Can a <em>producer</em> read from the shared memory ?</li>
<li>Can a <em>consumer</em> write to the shared memory ?</li>
<li>How do both process now which data is shared ? In other words, how does the consumer decide which memory it connects to ?</li>
</ul>

	</div>
</div>

<h3 id="message-passing">Message passing</h3>

<p>The second technique for for interprocess communication (IPC) comes in the form of signals. Here we touch on 2 mechanisms for achieving this.</p>

<h4 id="signals">Signals</h4>

<p>One mechanism comes in the form of <strong>signals</strong>. This is the cheapest form of IPC. It literally allows one process to send a signal to another process, through the use of the function <strong>kill()</strong>. Although the name might be a bit misleading, it can be used to send different signals. The snippet below shows the different types of signals that can be sent.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">jvliegen@localhost:~/$ kill -L
 1<span style="color:#f92672">)</span> SIGHUP   2<span style="color:#f92672">)</span> SIGINT   3<span style="color:#f92672">)</span> SIGQUIT  4<span style="color:#f92672">)</span> SIGILL   5<span style="color:#f92672">)</span> SIGTRAP
 6<span style="color:#f92672">)</span> SIGABRT  7<span style="color:#f92672">)</span> SIGBUS   8<span style="color:#f92672">)</span> SIGFPE   9<span style="color:#f92672">)</span> SIGKILL 10<span style="color:#f92672">)</span> SIGUSR1
11<span style="color:#f92672">)</span> SIGSEGV 12<span style="color:#f92672">)</span> SIGUSR2 13<span style="color:#f92672">)</span> SIGPIPE 14<span style="color:#f92672">)</span> SIGALRM 15<span style="color:#f92672">)</span> SIGTERM
16<span style="color:#f92672">)</span> SIGSTKFLT 17<span style="color:#f92672">)</span> SIGCHLD 18<span style="color:#f92672">)</span> SIGCONT 19<span style="color:#f92672">)</span> SIGSTOP 20<span style="color:#f92672">)</span> SIGTSTP
21<span style="color:#f92672">)</span> SIGTTIN 22<span style="color:#f92672">)</span> SIGTTOU 23<span style="color:#f92672">)</span> SIGURG  24<span style="color:#f92672">)</span> SIGXCPU 25<span style="color:#f92672">)</span> SIGXFSZ
26<span style="color:#f92672">)</span> SIGVTALRM 27<span style="color:#f92672">)</span> SIGPROF 28<span style="color:#f92672">)</span> SIGWINCH  29<span style="color:#f92672">)</span> SIGIO 30<span style="color:#f92672">)</span> SIGPWR
31<span style="color:#f92672">)</span> SIGSYS  34<span style="color:#f92672">)</span> SIGRTMIN  35<span style="color:#f92672">)</span> SIGRTMIN+1  36<span style="color:#f92672">)</span> SIGRTMIN+2  37<span style="color:#f92672">)</span> SIGRTMIN+3
38<span style="color:#f92672">)</span> SIGRTMIN+4  39<span style="color:#f92672">)</span> SIGRTMIN+5  40<span style="color:#f92672">)</span> SIGRTMIN+6  41<span style="color:#f92672">)</span> SIGRTMIN+7  42<span style="color:#f92672">)</span> SIGRTMIN+8
43<span style="color:#f92672">)</span> SIGRTMIN+9  44<span style="color:#f92672">)</span> SIGRTMIN+10 45<span style="color:#f92672">)</span> SIGRTMIN+11 46<span style="color:#f92672">)</span> SIGRTMIN+12 47<span style="color:#f92672">)</span> SIGRTMIN+13
48<span style="color:#f92672">)</span> SIGRTMIN+14 49<span style="color:#f92672">)</span> SIGRTMIN+15 50<span style="color:#f92672">)</span> SIGRTMAX-14 51<span style="color:#f92672">)</span> SIGRTMAX-13 52<span style="color:#f92672">)</span> SIGRTMAX-12
53<span style="color:#f92672">)</span> SIGRTMAX-11 54<span style="color:#f92672">)</span> SIGRTMAX-10 55<span style="color:#f92672">)</span> SIGRTMAX-9  56<span style="color:#f92672">)</span> SIGRTMAX-8  57<span style="color:#f92672">)</span> SIGRTMAX-7
58<span style="color:#f92672">)</span> SIGRTMAX-6  59<span style="color:#f92672">)</span> SIGRTMAX-5  60<span style="color:#f92672">)</span> SIGRTMAX-4  61<span style="color:#f92672">)</span> SIGRTMAX-3  62<span style="color:#f92672">)</span> SIGRTMAX-2
63<span style="color:#f92672">)</span> SIGRTMAX-1  64<span style="color:#f92672">)</span> SIGRTMAX  
jvliegen@localhost:~/$  </code></pre></div>
<p>The function of sending signals to other processes is to be used in programs. It also has CLI-compatible command <strong>kill</strong>. For more information on the kill command, add the <code>--help</code> argument, read the man-page (<code>man kill</code>), or ask the Internet.</p>

<p>Two short-cuts are typically available in the CLI that allow for the sending of signals: CTRL+C and CTRL+Z. The former sends a <strong>SIGINT</strong> signal while the latter sends a <strong>SIGTSTP</strong> signal.</p>

<p>Let&rsquo;s illustrate this with an example.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;unistd.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#75715e">#define DURATION_IN_MINUTES 10
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">void</span>) {
  <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> DURATION_IN_MINUTES <span style="color:#f92672">*</span> <span style="color:#ae81ff">60</span>;

  <span style="color:#66d9ef">for</span>(;i<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">0</span>;i<span style="color:#f92672">--</span>) {
    printf(<span style="color:#e6db74">&#34;TIMER: 00:%02d:%02d</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, (<span style="color:#66d9ef">int</span>)((i<span style="color:#f92672">-</span>i<span style="color:#f92672">%</span><span style="color:#ae81ff">60</span>)<span style="color:#f92672">/</span><span style="color:#ae81ff">60</span>), i<span style="color:#f92672">%</span><span style="color:#ae81ff">60</span>);
    sleep(<span style="color:#ae81ff">1</span>);
  }

  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}</code></pre></div>
<p>This program will emulate an egg timer. Every second it displays how much time is left. Once the process starts running, it takes 10 minutes to complete. This process can be <strong>killed</strong> by just pressing CTRL+C.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">jvliegen@localhost:~/$ ./eg4_timer.bin 
TIMER: 00:10:00
TIMER: 00:09:59
TIMER: 00:09:58
TIMER: 00:09:57
TIMER: 00:09:56
^C
jvliegen@localhost:~/$ </code></pre></div>
<p>Another way to kill the process would be to explicitly send the signal through the kill command. To use this command, the <strong>PID</strong> is needed as an argument. Through a new CLI-window, this PID has to be search for first. Note that the type of signal is an argument in the command.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">jvliegen@localhost:~/$  ps ux | grep timer
jvliegen  <span style="color:#ae81ff">5041</span>  0.0  0.0   <span style="color:#ae81ff">4504</span>   <span style="color:#ae81ff">772</span> pts/1    S+   06:04   0:00 ./eg4_timer.bin
jvliegen  <span style="color:#ae81ff">5066</span>  0.0  0.0  <span style="color:#ae81ff">21996</span>  <span style="color:#ae81ff">1080</span> pts/2    S+   06:05   0:00 grep --color<span style="color:#f92672">=</span>auto timer
jvliegen@localhost:~/$  kill -KILL <span style="color:#ae81ff">5041</span>
jvliegen@localhost:~/$ </code></pre></div>

<div class="ex">
	<div class="inner">
    	<p>Try this for yourself. In the git repository for this course (in the VM), there is the <em>longhello</em> program (~/osc-exercises/ch6_tasks/longhello.c). Run this program and try to kill it using <strong>both</strong> approaches that were explained above. (Offcourse this means you shoud run it again, after you killed it the first time 😃 )</p>

	</div>
</div>

<p>Although there are numerous uses for sending signals between signals, one more example is interesting to have a closer look at. Above there was already some hinting to <strong>CTRL+Z</strong>.</p>

<p>The CLI is running a shell, as you already know by now. This offers just a single interface. If you were to start a program, that CLI is occupied. Imagine you are working remotely on a server (e.g. through ssh), this would require you to open up a new connection to the server and have a second bash at your disposal. A more convenient solution would be to send the running program to the <strong>background</strong>.</p>

<figure>
    <img src="../../img/os/sc_xeyes.png"/> <figcaption>
            <h4>An example of a program that needs to be killed with CTRL-C</h4>
        </figcaption>
</figure>

<p>Before you can send processes to the background, the process has to be halted first. This can be done through the CTRL+Z shortcut. With a halted process, the command <strong>bg</strong> sends the halted process to the background. If you do not send it to the background, the process will <em>freeze</em>. Once it is in the background it <em>unfreezes</em> and continues running. Additionally, this would give you back your shell.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">jvliegen@localhost:~/$ xeyes 
^Z
<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span>+  Stopped                 xeyes
jvliegen@localhost:~/$ bg
<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span>+ xeyes &amp;
jvliegen@localhost:~/$ </code></pre></div>
<p>For the sake of completeness we enumerate a few more usefull aspects about this:</p>

<ul>
<li>a process can be started in the background as well. This can be achieved by adding an <strong>ampersand</strong> after the command: eg. xeyes &amp;</li>
<li>the command <strong>jobs</strong> gives you an overview of which jobs are running in the background</li>
<li>through the command <strong>fg &lt;#&gt;</strong> the job with index number &lt;#&gt; will pulled to foreground.</li>
</ul>


<div class="ex">
	<div class="inner">
    	<p>Try this for yourself. If the <strong>xeyes</strong> program is not installed, install it !!</p>

<p>Reminder :</p>

<ul>
<li>sudo apt-cache search <em>string</em></li>
<li>sudo apt-get install <em>package-name</em></li>
</ul>

	</div>
</div>

<h4 id="pipes">Pipes</h4>

<p>Another option to achieve signal sending is through <strong>pipes</strong>. There are two different types of pipes available:</p>

<ul>
<li>anonymous pipes</li>
<li>named pipes</li>
</ul>

<p><strong>Anonymous pipes</strong> are like tubes with two ends. Communication is half-duplex, to that means single direction only. A pipe could be attached to a process through a file descriptor. One process could <strong>write</strong> into the pipe, while the other could <strong>read</strong> from of the pipe. This type of pipe can only be create between two processes that have parent-child relation ship.</p>

<p>When using the CLI, anonymous pipes are a very powerful tool for chaining different commands. The output of the first command will be the input for the next command. This can be chained multiple times</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">jvliegen@localhost:~/$ xeyes &amp;
jvliegen@localhost:~/$ ps u | grep xeyes | head -1 | cut -d <span style="color:#e6db74">&#34; &#34;</span> -f <span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">5526</span>
jvliegen@localhost:~/$ </code></pre></div>
<p>The example above chains the following:</p>

<ol>
<li>give a list of all <em>my</em> processes</li>
<li>only filter the lines that contain the word <em>xeyes</em></li>
<li>filter only the first line</li>
<li>split the input on a &ldquo; &rdquo; (a space) and report only the third field</li>
</ol>

<p>Do you remember the Process Control Block ? This has one field called <strong>list of open files</strong>. We&rsquo;ve already touched upon STDOUT and co. Using anonymous pipes will add an entry to this list.</p>

<p>As a quick reminder: Every process has at least 3 open files. These can be <em>relinked</em> as shown in the example below.</p>

<ul>
<li>process &lt; STDIN 1&gt;STDOUT 2&gt;STDERR</li>
<li>process &lt; STDIN 1&gt;STDOUT 2&gt;&amp;1</li>
</ul>

<figure>
    <img src="../../img/os/sc_redirect_stdout.png"/> <figcaption>
            <h4>Redirection of the standard output </h4>
        </figcaption>
</figure>

<p><strong>Named pipes</strong> are the other type of pipes that can be created. The main differences are the lifetime of this mechanism and their presence in the file system.</p>

<p>The anonymous pipes above only live as long as the processes live. Named pipes have to be closed explicitly (or are closes automatically at system-shutdown).</p>

<p>Named pipes have a presence in the file system. That is, they show up as files. But unlike most files, they never appear to have contents. Even if you write a lot of data to a named pipe, the file appears to be empty. Making named pipes can be done through the <strong>mkfifo</strong> command.</p>

<p>As they are not frequently used we leave the interested reader to man page 😃.</p>

<h2 id="communication-between-threads">Communication between threads</h2>

<p>One <em>raison d&rsquo;être</em> for multi-threaded applications is <strong>resource sharing</strong>. In the example that was given <a href="../../ch6-tasks/threads/#pthreads">earlier</a> a <strong>global variable</strong> &lsquo;counter&rsquo; was used. No measures were taken for securing this approach it went wrong in that example. The output of the example looks like shown below.</p>

<figure>
    <img src="../../img/os/sc_631.png"/> 
</figure>

<p>This might come as a surprise 😃 <br/>
It should be clear that what we wanted to see was <em>Job 1 started</em> followed by <em>Job 1 finished</em> and that this would be repeated again for job number 2.</p>

<p>The first of both threads that gets to its function increments the counter from 0 to 1. However, before this thread has finished its execution, the second thread has started and has incremented the counter from 1 to 2. By the time the first thread finishes, the counter value is 2 in contrast with the intended value of 1.</p>

<h3 id="mutex">Mutex</h3>

<p>The simplest form of solving inter-thread communication issues is the use of a mutex. This is a portmanteau of <strong>Mut</strong>ual <strong>Ex</strong>clusion. The behaviour can be seen as the lock on a toilet door. If you are using the toilet, you <strong>lock</strong> the door. Others that want to occupy the toilet have to wait until you&rsquo;re finished and you <strong>unlock</strong> the door (and get out, after washing your hands). Hence, the mutex has only two states: one or zero, on or off, &hellip;</p>

<p>The concept of a mutex is implemented in the pthreads library as a new variable type: <strong>pthread_mutex_t</strong>. Locking and unlocking can be done through functions <strong>pthread_mutex_lock()</strong> and <strong>pthread_mutex_unlock()</strong>. As always, read the documentation for the exact usage of these functions.</p>

<p>The example above can be rewritten using a mutex:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;string.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;pthread.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;unistd.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">int</span> counter;
pthread_mutex_t lock_counter;                   <span style="color:#75715e">/* THIS LINE HAS BEEN ADDED */</span>

<span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> <span style="color:#a6e22e">doSomeThing</span>(<span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>arg) {
    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">long</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;

    <span style="color:#66d9ef">int</span> id;                                     <span style="color:#75715e">/* THIS LINE HAS BEEN ADDED */</span>
    pthread_mutex_lock(<span style="color:#f92672">&amp;</span>lock_counter);          <span style="color:#75715e">/* THIS LINE HAS BEEN ADDED */</span>
    counter <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>;
    id <span style="color:#f92672">=</span> counter;                               <span style="color:#75715e">/* THIS LINE HAS BEEN ADDED */</span>
    pthread_mutex_unlock(<span style="color:#f92672">&amp;</span>lock_counter);        <span style="color:#75715e">/* THIS LINE HAS BEEN ADDED */</span>


    printf(<span style="color:#e6db74">&#34;  Job %d started</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, id);           <span style="color:#75715e">/* THIS LINE HAS BEEN CHANGED */</span>
    <span style="color:#66d9ef">for</span>(i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>; i<span style="color:#f92672">&lt;</span>(<span style="color:#ae81ff">0xFFFFFFFF</span>);i<span style="color:#f92672">++</span>);
    printf(<span style="color:#e6db74">&#34;  Job %d finished</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, id);          <span style="color:#75715e">/* THIS LINE HAS BEEN CHANGED */</span>

    <span style="color:#66d9ef">return</span> NULL;
}

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">void</span>) {
  <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, err;
  pthread_t tid[<span style="color:#ae81ff">2</span>];

  <span style="color:#66d9ef">while</span>(i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span>) {
    err <span style="color:#f92672">=</span> pthread_create(<span style="color:#f92672">&amp;</span>(tid[i]), NULL, <span style="color:#f92672">&amp;</span>doSomeThing, NULL);
    <span style="color:#66d9ef">if</span> (err <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>) {
      printf(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">can&#39;t create thread :[%s]&#34;</span>, strerror(err));
    }
    i<span style="color:#f92672">++</span>;
  }

  pthread_join(tid[<span style="color:#ae81ff">0</span>], NULL);
  pthread_join(tid[<span style="color:#ae81ff">1</span>], NULL);

  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}</code></pre></div>
<p>This solves the issue that was encountered above. Before the counter is accessed the mutex is locked. This provides exclusive access. The counter is then incremented and copied in to variable <em>id</em>. Finally, the mutex is unlocked.</p>

<p>With this measure in place, the result is as was intended.
<figure>
    <img src="../../img/os/sc_mutex.png"/>
</figure></p>

<p><strong>PROTIP:</strong> It is pointed out that the time (directionally proportional the number of instructions) between locking and unlocking a mutex should be kept to a minimum. Other threads might be waiting for the mutex to become available.</p>

<h3 id="semaphore">Semaphore</h3>

<p>A more advance technique for synchronisation, in comparison with a mutex, is a semaphore. To illustrate this, a semaphore can be thought of as a bowl with tokens. For example, in daycare there can be a room with toys.</p>

<figure>
    <img src="https://media-cdn.tripadvisor.com/media/photo-s/03/c6/74/b4/cafe-boulevard.jpg" width="50%"/> <figcaption>
            <h4>This photo of Cafe Boulevard is courtesy of Tripadvisor</h4>
        </figcaption>
</figure>

<p>Only 5 children are allowed in that room. Outside, there is a bowl with bracelets. When a child wants to enter the room to play, he/she needs to take a bracelet and put it on. When there are not more bracelets, a child that also wants to play in the room has to wait until another child leaves the room and places his/her bracelet back in the bowl.</p>

<p>This technique is used in e.g. producer-consumer problems, amongst many other types. In contrast with the mutex, a semaphore can have multiple states. It is <em>number</em> of tokens. It is pointed out that if there is only a single token in the semaphore, this behaves exactly the same as a mutex. Such a semaphore is referred to as a <strong>binary semaphore</strong>.</p>

<p>The <strong>pthreads</strong> library also provides an API to program with semaphores. It contains, amongst others, functions like:</p>

<ul>
<li>sem_init(): initialises a semaphore</li>
<li>sem_wait(): decrements the number inside of the semaphore.</li>
<li>sem_post(): increments the number inside of the semaphore.</li>
</ul>

<p>Note that the <code>sem_wait()</code> function is blocking. If the value of the semaphore is set to zero, the thread waits until it can acquire a lock. There is a non-blocking alternative sem_trywait(). See the manual pages for more info and the correct usage.</p>

<p>Next to fact that a mutex only has a single token, where a semaphore can have more, the signalling is also a main difference. When a thread wants to get access to a semaphore and there are no more tokens available, it goes into a sleep-like state. When another thread produces a semaphore, a signal is sent to all the threads that were &lsquo;sleeping&rsquo;.</p>

<p>More info on the differences between a semaphore and a mutex are given <a href="https://techdifferences.com/difference-between-semaphore-and-mutex.html">here</a>.</p>


<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="../../ch6-tasks/lab2_threadsmgmt/" title="6.4: Threads (lab)"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="../../ch6-tasks/lab3_intertaskcomm/" title="6.6: Inter task communication (lab)" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="../../js/clipboard.min.js?1613375963"></script>
    <script src="../../js/perfect-scrollbar.min.js?1613375963"></script>
    <script src="../../js/perfect-scrollbar.jquery.min.js?1613375963"></script>
    <script src="../../js/jquery.sticky.js?1613375963"></script>
    <script src="../../js/featherlight.min.js?1613375963"></script>
    <script src="../../js/highlight.pack.js?1613375963"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="../../js/modernizr.custom-3.6.0.js?1613375963"></script>
    <script src="../../js/learn.js?1613375963"></script>
    <script src="../../js/hugo-learn.js?1613375963"></script>
    
        
            <script src="../../mermaid/mermaid.js?1613375963"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

